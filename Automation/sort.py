import requests
import sys
import json
import time
import os, fnmatch
import hashlib

file1 = open("sort_report.txt","a")
listOfFiles = os.listdir('.')
listOfFiles.sort()
anomalies = 0 
suffix = "_obfuscated.apk"
pattern = "*_obfuscated.apk"
#Loop to check if original apk has obfuscated apk
for entry in listOfFiles:
    if entry.endswith(suffix) == False:
        if entry.endswith('.apk') == True:
            found = 0
            #print ("Filename :", entry)
            match = entry
            match = match.strip('.apk')
            match = match + "_obfuscated.apk"
            #print("Apk to be matched = " + match) 
            for orig in listOfFiles:
                if match == orig:
                    #print("Match found for : " + orig + "\n")
                    found = 1
            if found == 0:
                print("No obfuscated found for : " + entry + "\n")
                anomalies = anomalies + 1
                file1.write("Apk Name = " + entry + "\n")
                cmdtoremove = "rm \""+ entry + "\""
                os.system(cmdtoremove)
#Loop to check if obfuscated apk has original apk              
for entry in listOfFiles:
    if fnmatch.fnmatch(entry, pattern):
            found = 0
            #print ("Filename :", entry)
            match = entry
            match = match.strip("_obfuscated.apk")
            match = match + ".apk"
            #print("Apk to be matched = " + match) 
            for orig in listOfFiles:
                if match == orig:
                    #print("Match found for : " + orig + "\n")
                    found = 1
            if found == 0:
                print("No orginal apk found for: " + entry + "\n")
                anomalies = anomalies + 1
                file1.write("Apk Name = " + entry + "\n")
                cmdtoremove = "rm \""+ entry + "\""
                os.system(cmdtoremove)
file1.write("Files Deleted = " + str(anomalies) + "\n")                 
print("Files to be deleted = "+ str(anomalies))

